cmake_minimum_required(VERSION 2.6)

project(GrandOrgue CXX)

# Build configuration options
if (NOT DEFINED UNICODE)
   set(UNICODE OFF)
endif ()
if (NOT DEFINED RTAUDIO_USE_JACK)
  set(RTAUDIO_USE_JACK ON)
endif ()
if (NOT DEFINED RTAUDIO_USE_OSS)
  set(RTAUDIO_USE_OSS OFF)
endif ()
if (NOT DEFINED RTAUDIO_USE_ALSA)
  set(RTAUDIO_USE_ALSA ON)
endif ()
if (NOT DEFINED RTAUDIO_USE_DSOUND)
  set(RTAUDIO_USE_DSOUND ON)
endif ()
if (NOT DEFINED RTAUDIO_USE_ASIO)
  set(RTAUDIO_USE_ASIO ON)
endif ()
if (NOT DEFINED RTMIDI_USE_JACK)
  set(RTMIDI_USE_JACK ON)
endif ()
if (NOT DEFINED RTMIDI_USE_ALSA)
  set(RTMIDI_USE_ALSA ON)
endif ()
if (NOT DEFINED RTMIDI_USE_MM)
  set(RTMIDI_USE_MM ON)
endif ()

# Project version numbers
set(VERSION_MAJOR 0)
set(VERSION_MINOR 3)
set(VERSION_STAGE 0)
set(VERSION_REVISION 3)
set(VERSION ${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_STAGE}.${VERSION_REVISION})

if (CMAKE_BUILD_TYPE STREQUAL "")
   message(STATUS "No build configuration specified. Defaulting to 'Release' build.")
   set(CMAKE_BUILD_TYPE "Release")
endif ()

# setup compiler flags for debug vs release compiles
add_definitions("-fomit-frame-pointer -ffast-math -Wall")
if (CMAKE_BUILD_TYPE STREQUAL "Debug")
   add_definitions("-g -O0 -mmmx -msse -msse2 -msse3 -funit-at-a-time")
elseif (CMAKE_BUILD_TYPE STREQUAL "Release")
   add_definitions("-O3 -mmmx -msse -msse2 -msse3 -DNDEBUG")
endif ()

# include RtAudio
add_subdirectory(src/rt lib/rt)
add_subdirectory(src/grandorgue bin)
add_subdirectory(po)
add_subdirectory(help)

set(CPACK_PACKAGE_NAME "GrandOrgue")
set(CPACK_PACKAGE_VENDOR "Our Organ")
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "GrandOrgue - OpenSource Virtual Pipe Organ Software")
set(CPACK_PACKAGE_VERSION ${VERSION})
set(CPACK_PACKAGE_VERSION_MAJOR ${VERSION_MAJOR})
set(CPACK_PACKAGE_VERSION_MINOR ${VERSION_MINOR})
set(CPACK_PACKAGE_VERSION_PATCH ${VERSION_STAGE}.${VERSION_REVISION})
set(CPACK_PACKAGE_INSTALL_DIRECTORY "GrandOrgue")
set(CPACK_RPM_PACKAGE_LICENSE "GPL v2+")
set(CPACK_PACKAGE_CONTACT "ourorgan-developers@lists.sourceforge.net")
set(CPACK_STRIP_FILES true)
include(CPack)

message(STATUS "  Project                     : ${PROJECT_NAME}")
message(STATUS "  Description                 : ${CPACK_PACKAGE_DESCRIPTION_SUMMARY}")
message(STATUS "  Version                     : ${VERSION}")
message(STATUS "============================================================================")
message(STATUS " ")
